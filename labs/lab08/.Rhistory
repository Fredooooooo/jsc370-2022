knitr::opts_chunk$set(eval = F, include  = T)
install.packages("tidytext")
library(tidytext)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(wordcloud)
mt_samples <- read_csv("https://raw.githubusercontent.com/JSC370/jsc370-2022/main/data/medical_transcriptions/mtsamples.csv")
mt_samples <- mt_samples %>%
select(description, medical_specialty, transcription)
head(mt_samples)
mt_samples %>%
count(, sort = TRUE)
mt_samples %>%
count(medical_specialty, sort = TRUE) %>%
ggplot(aes(medical_specialty, n)) + geom_col() + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(word, transcription)
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(word, transcription) %>% group_by(word) %>% summarize(word_frequency = n())
tokens
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(word, transcription) %>% group_by(word) %>% summarize(word_frequency = n()) %>% arrange(across(word_frequency, desc)) %>% head(20)
tokens %>% ggplot(aes(word, word_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(word, transcription) %>% group_by(word) %>% summarize(word_frequency = n()) %>% arrange(across(word_frequency, desc)) %>% head(20)
tokens %>% ggplot(aes(x=reorder(word, word_frequency), y=word_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(word, transcription) %>% group_by(word) %>% summarize(word_frequency = n()) %>% arrange(across(word_frequency, desc)) %>% head(20)
tokens %>% ggplot(aes(x=reorder(word, word_frequency), y=word_frequency)) + geom_bar(stat='identity') + coord_flip()
library(wordcloud)
wordcloud(tokens$word, tokens$word_frequency)
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(word, transcription) %>% anti_join(stop_words, by="word") %>% subset(!grepl("^\\d+$", word))
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(word, transcription) %>% anti_join(stop_words, by="word") %>% subset(!grepl("^\\d+$", word)) %>% group_by(word) %>% summarise(word_frequency = n()) %>% arrange(across(word_frequency, desc)) %>% head(20)
tokens %>% ggplot(aes(x=reorder(word, word_frequency), y=word_frequency)) + geom_bar(stat='identity') + coord_flip()
wordcloud(tokens$word, tokens$word_frequency)
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(bigram, transcription, token='ngrams', n=2) %>% group_by(bigram) %>% summarise(bigram_frequency = n())
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(bigram, transcription, token='ngrams', n=2) %>% group_by(bigram) %>% summarise(bigram_frequency = n()) %>% arrange(across(bigram_frequency, desc)) %>% head(20) %>% ggplot(aes(bigram, bigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(bigram, transcription, token='ngrams', n=2) %>% group_by(bigram) %>% summarise(bigram_frequency = n()) %>%
separate(bigram, c("word1", "word2"), extra="drop", remove=F, sep=" ", fill="right") %>%
arrange(across(bigram_frequency, desc)) %>% head(20) %>% ggplot(aes(bigram, bigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(bigram, transcription, token='ngrams', n=2) %>% group_by(bigram) %>% summarise(bigram_frequency = n()) %>%
separate(bigram, c("word1", "word2"), extra="drop", remove=F, sep=" ", fill="right")
tokens %>%
anti_join(stop_words, by=c("word1", "word")) %>% anti_join(stop_words, by=c("word2", "word")) %>%
arrange(across(bigram_frequency, desc)) %>% head(20) %>% ggplot(aes(bigram, bigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(bigram, transcription, token='ngrams', n=2) %>% group_by(bigram) %>% summarise(bigram_frequency = n()) %>%
separate(bigram, c("word1", "word2"), extra="drop", remove=F, sep=" ", fill="right")
tokens %>%
anti_join(stop_words, by=c("word1"="word")) %>% anti_join(stop_words, by=c("word2"="word")) %>%
arrange(across(bigram_frequency, desc)) %>% head(20) %>% ggplot(aes(bigram, bigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(bigram, transcription, token='ngrams', n=2) %>% group_by(bigram) %>% summarise(bigram_frequency = n()) %>%
separate(bigram, c("word1", "word2"), extra="drop", remove=F, sep=" ", fill="right")
tokens %>%
anti_join(stop_words, by=c("word1"="word")) %>% anti_join(stop_words, by=c("word2"="word")) %>%   subset(!grepl("\\d+", bigram)) %>%
arrange(across(bigram_frequency, desc)) %>% head(20) %>% ggplot(aes(bigram, bigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(trigram, transcription, token='ngrams', n=3) %>% group_by(trigram) %>% summarise(trigram_frequency = n()) %>%
separate(trigram, c("word1", "word2"), extra="drop", remove=F, sep=" ", fill="right")
tokens %>%
anti_join(stop_words, by=c("word1"="word")) %>% anti_join(stop_words, by=c("word2"="word")) %>%   subset(!grepl("\\d+", trigram)) %>%
arrange(across(trigram_frequency, desc)) %>% head(20) %>% ggplot(aes(trigram, trigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(trigram, transcription, token='ngrams', n=3) %>% group_by(trigram) %>% summarise(trigram_frequency = n()) %>%
separate(trigram, c("word1", "word2", "word3"), extra="drop", remove=F, sep=" ", fill="right")
tokens %>%
anti_join(stop_words, by=c("word1"="word")) %>% anti_join(stop_words, by=c("word2"="word")) %>%
anti_join(stop_words, by=c("word3"="word")) %>% subset(!grepl("\\d+", trigram)) %>%
arrange(across(trigram_frequency, desc)) %>% head(20) %>% ggplot(aes(trigram, trigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens %>% subset(word2 = "blood") %>% group_by(word1) %>% summarise(word1_freq = n()) %>% arrange(across(word1_freq, desc)) %>% head(20)
tokens %>% subset(word2 = "blood") %>% group_by(word3) %>% summarise(word3_freq = n()) %>% arrange(across(word3_freq, desc)) %>% head(20)
tokens %>% subset(word2 == "blood") %>% group_by(word1) %>% summarise(word1_freq = n()) %>% arrange(across(word1_freq, desc)) %>% head(20)
tokens %>% subset(word2 == "blood") %>% group_by(word3) %>% summarise(word3_freq = n()) %>% arrange(across(word3_freq, desc)) %>% head(20)
tokens <- mt_samples %>% select(transcription) %>% unnest_tokens(trigram, transcription, token='ngrams', n=3) %>% group_by(trigram) %>% summarise(trigram_frequency = n()) %>%
separate(trigram, c("word1", "word2", "word3"), extra="drop", remove=F, sep=" ", fill="right") %>%
anti_join(stop_words, by=c("word1"="word")) %>% anti_join(stop_words, by=c("word2"="word")) %>%
anti_join(stop_words, by=c("word3"="word")) %>% subset(!grepl("\\d+", trigram)) %>%
arrange(across(trigram_frequency, desc))
tokens %>% head(20) %>% ggplot(aes(trigram, trigram_frequency)) + geom_bar(stat='identity') + coord_flip()
tokens %>% subset(word2 == "blood") %>% group_by(word1) %>% summarise(word1_freq = n()) %>% arrange(across(word1_freq, desc)) %>% head(20) %>% ggplot(aes(word1, word1_freq)) + geom_bar(stat='identity') + coord_flip()
tokens %>% subset(word2 == "blood") %>% group_by(word3) %>% summarise(word3_freq = n()) %>% arrange(across(word3_freq, desc)) %>% head(20) %>% ggplot(aes(word3, word3_freq)) + geom_bar(stat='identity') + coord_flip()
dim(tokens)
mt_samples %>% unnest_tokens(word, transcription) %>% anti_join(stop_words, by="word") %>% subset(!grepl("^\\d+$", word)) %>% group_by(medical_specialty) %>% count(word, sort=T) %>% top_n(5,n) %>% ggplot(aes(x=medical_specialty, y=n, color=word)) + geom_bar(stat = "identity") + coord_flip()
mt_samples %>% unnest_tokens(word, transcription) %>% anti_join(stop_words, by="word") %>% subset(!grepl("^\\d+$", word)) %>% group_by(medical_specialty) %>% count(word, sort=T) %>% top_n(5,n) %>% ggplot(aes(x=medical_specialty, y=n, color=word, fill=word)) + geom_bar(stat = "identity") + coord_flip()
mt_samples %>% unnest_tokens(word, transcription) %>% anti_join(stop_words, by="word") %>% subset(!grepl("^\\d+$", word)) %>% group_by(medical_specialty) %>% count(word, sort=T) %>% top_n(5,n) %>% ggplot(aes(x=medical_specialty, y=n, fill=word)) + geom_bar(stat = "identity") + coord_flip()
mt_samples %>% unnest_tokens(word, transcription) %>% anti_join(stop_words, by="word") %>% subset(!grepl("^\\d+$", word)) %>% group_by(medical_specialty) %>% count(word, sort=T) %>% top_n(1,n) %>% ggplot(aes(x=medical_specialty, y=n, fill=word)) + geom_bar(stat = "identity") + coord_flip()
mt_samples %>% select(transcription) %>% unnest_tokens(quadgram, transcription, token='ngrams', n=4) %>% count(quadgram, sort=T) %>% top_n(20,n) %>% ggplot(aes(quadgram, n)) + geom_bar(stat = "identity") + coord_flip()
